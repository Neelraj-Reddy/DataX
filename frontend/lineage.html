<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DataX - Data Lineage</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="styles/ultra-modern.css" rel="stylesheet">
  <script type="text/javascript" src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js"></script>
</head>
<body>
  <!-- Modern Sidebar Navigation -->
  <nav class="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-logo">
        <i class="fas fa-database"></i>
      </div>
      <h2 class="sidebar-title">DataX</h2>
    </div>
    
    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
        <a href="index.html" class="sidebar-nav-link">
          <i class="fas fa-home sidebar-nav-icon"></i>
          Dashboard
        </a>
      </li>
      <li class="sidebar-nav-item">
        <a href="transform.html" class="sidebar-nav-link">
          <i class="fas fa-exchange-alt sidebar-nav-icon"></i>
          Transform
        </a>
      </li>
      <li class="sidebar-nav-item">
        <a href="load.html" class="sidebar-nav-link">
          <i class="fas fa-upload sidebar-nav-icon"></i>
          Load Data
        </a>
      </li>
      <li class="sidebar-nav-item">
        <a href="lineage.html" class="sidebar-nav-link active">
          <i class="fas fa-project-diagram sidebar-nav-icon"></i>
          Lineage
        </a>
      </li>
      <li class="sidebar-nav-item">
        <a href="editor.html" class="sidebar-nav-link">
          <i class="fas fa-code sidebar-nav-icon"></i>
          SQL Editor
        </a>
      </li>
    </ul>
  </nav>

  <!-- Main Content Area -->
  <main class="main-content">
    <div class="page-header">
      <h1 class="page-title">Data Lineage</h1>
      <p class="page-subtitle">Visualize data flow and dependencies across your transformations</p>
    </div>

    <!-- Lineage Controls -->
    <div class="card mb-4">
      <div class="card-header">
        <h3 class="card-title">
          <i class="fas fa-sliders-h text-accent" style="margin-right: 0.5rem;"></i>
          Lineage Configuration
        </h3>
      </div>
      <div class="card-body">
        <div style="display: grid; grid-template-columns: 1fr 1fr auto; gap: 1.5rem; align-items: end;">
          <div class="form-group">
            <label for="table-select" class="form-label">Source Table</label>
            <select id="table-select" class="form-control">
              <option value="">Select a table to trace...</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="parent-level" class="form-label">
              Depth Level
              <span class="text-muted" style="font-size: 0.875rem;">(How many levels to trace)</span>
            </label>
            <input type="number" id="parent-level" class="form-control" min="1" max="10" value="3">
          </div>
          
          <button id="update-lineage-btn" class="btn btn-primary">
            <i class="fas fa-sync-alt" style="margin-right: 0.5rem;"></i>
            Update Lineage
          </button>
        </div>
        
        <!-- Lineage Legend -->
        <div class="mt-4 p-3 bg-secondary rounded">
          <h5 class="text-primary mb-3">Legend</h5>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <div class="d-flex align-items-center">
              <div style="width: 20px; height: 20px; background: var(--accent-blue); border-radius: 50%; margin-right: 0.75rem;"></div>
              <span class="text-secondary">Source Tables</span>
            </div>
            <div class="d-flex align-items-center">
              <div style="width: 20px; height: 20px; background: var(--accent-warm); border-radius: 50%; margin-right: 0.75rem;"></div>
              <span class="text-secondary">Transform Tables</span>
            </div>
            <div class="d-flex align-items-center">
              <div style="width: 20px; height: 20px; background: var(--accent-green); border-radius: 50%; margin-right: 0.75rem;"></div>
              <span class="text-secondary">Output Tables</span>
            </div>
            <div class="d-flex align-items-center">
              <div style="width: 30px; height: 3px; background: var(--accent-purple); margin-right: 0.75rem;"></div>
              <span class="text-secondary">Data Flow</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Status Messages -->
    <div id="status-message"></div>

    <!-- Lineage Visualization -->
    <div class="card">
      <div class="card-header">
        <div class="d-flex justify-content-between align-items-center">
          <h3 class="card-title">
            <i class="fas fa-project-diagram text-accent" style="margin-right: 0.5rem;"></i>
            Lineage Graph
          </h3>
          <div class="d-flex" style="gap: var(--space-3);">
            <button class="btn btn-sm btn-primary" onclick="fitToScreen()">
              <i class="fas fa-expand-arrows-alt" style="margin-right: var(--space-2);"></i>
              Fit to Screen
            </button>
            <button class="btn btn-sm btn-secondary" onclick="centerNetwork()">
              <i class="fas fa-crosshairs" style="margin-right: var(--space-2);"></i>
              Center
            </button>
            <button class="btn btn-sm btn-accent" onclick="zoomIn()">
              <i class="fas fa-search-plus" style="margin-right: var(--space-2);"></i>
              Zoom In
            </button>
            <button class="btn btn-sm btn-ghost" onclick="zoomOut()">
              <i class="fas fa-search-minus" style="margin-right: var(--space-2);"></i>
              Zoom Out
            </button>
          </div>
        </div>
      </div>
      <div class="card-body" style="padding: 0;">
        <div id="network" style="height: 600px; background: var(--bg-secondary); border-radius: 0 0 var(--radius-2xl) var(--radius-2xl); border: 1px solid var(--border-subtle);"></div>
      </div>
    </div>

    <!-- Lineage Details -->
    <div class="card mt-4" id="lineage-details" style="display: none;">
      <div class="card-header">
        <h4 class="card-title">
          <i class="fas fa-info-circle text-accent" style="margin-right: 0.5rem;"></i>
          Selected Node Details
        </h4>
      </div>
      <div class="card-body" id="node-details">
        <!-- Node details will be populated by JavaScript -->
      </div>
    </div>
  </main>

  <script src="script/lineage.js"></script>
</body>
</html>
